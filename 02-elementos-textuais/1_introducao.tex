% -----------------------------------------------------------------------------
%   Arquivo: ./02-elementos-textuais/introducao.tex
% -----------------------------------------------------------------------------

\chapter{Introdução}
\label{chap:introducao}

Ao observar o comportamento de diferentes populações de seres vivos, \textit{e.g.}, insetos, aves e mamíferos, dois fatores do seu modo de vida parecem estar correlacionados: a diversidade dos indivíduos e a maneira como colaboram. A colaboração, sem dúvida, contribuí para a sobrevivência da população, principalmente se esta é mais fraca que o seu predador natural ou está em desvantagem em relação ao ambiente. Tomando como exemplo o caso das formigas: não parece razoável imaginar que uma única formiga, ou ainda um grupo muito pequeno, conseguiria cortar folhas, carregá-las para o formigueiro, defender o seu lar, enquanto procriam para perpetuar a espécie. Entretanto, colaborando na casa dos milhares de indivíduos, elas alcançam sucesso em sobreviver e se procriar.

Em sua obra intitulada \textit{"Árvore do Conhecimento}, \citeonline{maturana2001} dão alguns exemplos deste tipo de  fenômeno social. Os autores apresentam, como exemplo, a estratégia dos rebanhos de antílopes para se comunicar e fugir de uma ameaça de coordenada, sempre ficando um indivíduo para trás em um local mais alto, de modo a observar a retaguarda do grupo. Na sequência, o autor aborda a interação de uma alcateia de lobos que colabora para caçar um animal.

\begin{quote}
\textit{Essa forma peculiar de conduta, em que animais distintos cumprem papéis distintos, permite que os membros do rebanho relacionem-se em atividades que não lhes seriam possíveis como indivíduos isolados. Além desse exemplo de fuga, há muitos outros no sentido inverso; Por exemplo, os lobos vivem também em grupos, coordenando suas condutas mediante várias interações olfativas, faciais e corporais, como o mostrar dos dentes, o abaixar das orelhas e o mover da cauda, como vemos nos cães domésticos. Tal grupo, como unidade social, é capaz de perseguir e matar um gigantesco alce, façanha que não estaria à altura de nenhum lobo solitário.} \cite{maturana2001}
\end{quote}

Aqui, \citeonline{maturana2001} ressaltam o papel da diversidade na maneira como os animais colaboram, quando falam em animais que cumprem papéis distintos, com comportamentos e habilidades diferentes. As formigas, por exemplo, tem papéis muito específicos dentro do formigueiro para conseguirem cooperar com sucesso. Algumas trabalham em coletar alimento, outras defendem o formigueiro, e os machos juntamente com a rainha são responsáveis pela reprodução \cite{maturana2001}. Cada indivíduo na população tem uma morfologia adaptada e específica para aquela tarefa. Mas ainda assim, não são suficientes sozinhos para desempenha-la com sucesso. Uma formiga com as presas mais afiadas do que as demais poderia ser muito mais rápida para cortar uma folha, mas ainda assim não conseguiria abastecer o formigueiro inteiro sozinha. 

\citeonline{maturana2001} sublinham que outro ponto importante para o surgimento de um comportamento colaborativo é a comunicação. Espécies que possuem um repertório comunicacional maior conseguem se organizar de maneira mais complexa. Um exemplo disto é a própria espécie humana, que possui um repertório de comunicação vasto comparado com o dos lobos ou antílopes. O historiador Yuval Noah Harari, no seu popular \textit{"Sapiens: Uma Breve História da Humanidade"} argumenta que a capacidade de falar argumentar sobre coisas abstratas, de realizar comércio, de compartilhar crenças, levou a espécie \textit{H. Sapiens} a sobressair sobre as demais especies do gênero \textit{Homo}.

\begin{quote}
\textit{Em uma briga de um para um, provavelmente um neandertal teria derrotado um sapiens. Mas em um conflito de centenas, os neandertais não teriam uma chance sequer. Os neandertais podiam partilhar informações sobre o paradeiro de leões, mas provavelmente não podiam contar - e revisar - histórias sobre espíritos tribais. Sem a capacidade de criar ficção, os neandertais não conseguiam cooperar efetivamente em grande número nem adaptar o seu ambiente social para responder aos desafios em rápida transformação. [...] \\ Se Sapiens arcaicos que acreditavam em tais ficções trocaram conchas e obsidianas, é razoável pensar que também podem ter trocado informações, criando assim redes de conhecimento muito mais amplas e mais densas do que a que serviu aos neandertais e a outros humanos arcaicos. [...] \\
Cinquenta neandertais cooperando em padrões tradicionais e estáticos não eram páreo para cinco centenas de Sapiens versáteis e inovadores.} \cite{harari2014}
\end{quote}

Novamente o conceito de diversidade aparece em \citeonline{harari2014}. O autor argumenta que, o ser humano consegue cooperar de uma maneira dinâmica e diversa e que, essa não é uma capacidade presente em todos os seres vivos. Baseado nos excertos apresentados, é razoável dizer que na natureza há uma correlação entre a complexidade da cooperação e a complexidade das interações entre os agentes da população. Dito de outra maneira, quanto maior a diversidade dos agentes, e quanto maior as possibilidades de comunicação entre esses agentes, maior a chance dessa população conseguir se adaptar a novas situações. 

Estes fenômenos populacionais apresentados acima são frequentemente usados na ciência da computação como inspiração para o desenvolvimento de novas técnicas e algoritmos. Tomando como exemplo a área específica da otimização, são vários os algoritmos chamados bioinspirados: algoritmos genéticos, colônia de formigas, enxame de partículas, entre outros \cite{binitha2012}. Essas técnicas mapeiam características particulares de um fenômeno biológico, \textit{e.g.} os algoritmos genético (GA, da sigla em inglês \textit{genetic algorithm}), são inspirados na deriva genética das espécies. Nesta técnica, uma solução para um problema de otimização é encarada como um indivíduo inserido em  uma população na qual ele pode se reproduzir e gerar descendentes que sofrem mutações. Esta população sofre uma pressão seletiva, de modo que os indivíduos mais adaptados tem maiores chances de sobreviver e gerar outros descendentes. No contexto dos GAs, dizer que uma solução $A$ é mais adaptada do que uma outra solução $B$ significa dizer que $f(A) < f(B)$ dado um mapeamento $f$, denominado função objetivo do problema. Esse tipo de técnica é amplamente aplicado em problemas do dia-a-dia, do estabelecimento de rotas de transporte ao despacho de energia elétrica. Na literatura eles são classificados como problemas do tipo $\mathcal{NP}$. Este conceito será esclarecido mais adiante, mas por enquanto, dizer que um problema $p$ pertencer a classe $\mathcal{NP}$ significa que resolvê-lo requer testar todas as possíveis soluções exaustivamente.

Uma outra área da ciência da computação que se inspira em conceitos populacionais e dinâmicas sociais é o estudo de sistemas complexos, principalmente apoiado pela modelagem de sistemas multi-agentes (MAS). Neste tipo de sistema, agentes podem interagir com o ambiente, o que inclui outros agentes, aprender a desempenhar uma determinada tarefa e se adaptar ao mundo em que estão inseridos \cite{holland2014}. Este tipo de abordagem é usada tanto para simular sistemas biológicos e estudar os modelos populacionais baseados na modelagem das interações entre os indivíduos, como para simular sistemas físicos, redes de tráfego, e sistemas distribuídos \citeonline{dorri2018}.

Como ambas as áreas de pesquisa mencionadas acima se baseiam no mesmo conjunto de fenômenos, é possível traçar paralelos entre a área de otimização, em especial a dos algoritmos bioinspirados, os sistemas multi-agentes, e os conceitos de colaboração e diversidade que introduzem o assunto deste capítulo. Retomando o exemplo do algoritmos genéticos, esta técnica é munida de um mecanismo de mutação, que mantêm a diversidade na população. Uma população pouco diversa pode levar o algoritmo a ficar preso em soluções ótimas locais, que em sua vizinhança são melhores do que as outras soluções, mas não são ótimos globais. O mecanismo de cruzamento do GA pode ser visto como uma estratégia de colaboração entre os indivíduos da população. Essas interações de mutação e cruzamento podem se dar de diversas maneiras, a depender da implementação do algoritmo, porem elas são codificadas de maneira estática. Por sua vez, uma rede de tráfego pode ser modelada usando a estratégia de sistemas multi-agentes. Os veículos podem colaborar entre si trocando mensagens usando sinais luminosos ou de rádio. Um sistema de tráfego pode ter uma diversidade de veículos, com diferentes tamanhos, capacidades motoras (\textit{drones}, carros, caminhões, trens). O sistema de comunicação entre os agentes pode ser tão complexo quanto possível, mas no caso de sistemas de transporte, a diversidade do sistema também é estática e limitada.

Como já observado, os padrões de colaboração e diversidade presentes nos algoritmos bioinspirados são limitados de modo que que, normalmente, eles são desenvolvidos e calibrados para uma família de problemas. Dificilmente um algoritmo projetado para problemas combinatórios tem um bom desempenho em problemas contínuos \cite{burke2003}. \citeonline{wolpert1997} já  Esta Uma estratégia para desenvolver algoritmos mais robustos, de modo a obter um bom desempenho em uma gama maior de problemas, é a combinação de técnicas diferentes estratégias bioinspiradas, ou mesmo com outros métodos matemáticos. Ainda assim, 

Em geral, o desenvolvimento de meta-heurísticas e suas combinações são difíceis de abordar pois é necessário um grande conhecimento do problema, e uma vez desenvolvida, é necessário calibrar os parâmetros numéricos do algoritmo, que podem ser muitos \cite{stutzle2018}. Isso torna um algoritmo eficiente em um tipo particular de problema ou em uma família de problemas, mas ineficiente em encontrar boas soluções para problemas diferentes.

Uma alternativa ao desenvolvimento de novas meta-heurísticas, ou a hibridização manual delas, é utilizar os mecanismos de colaboração e comunicação próprios da modelagem de sistemas multi-agentes (MMAS) para promover uma hibridização dinâmica de diferentes estratégias de busca \cite{gong2015, zheng2015, fernandes2009, milano2004}. São várias as arquiteturas e \textit{frameworks} disponíveis na literatura que alcançaram bons resultados utilizando a MMAS, entre elas destacam-se: AGE, CMA, JABAT, MACS, MANGO, AMAM \cite{silva2018} e a D-Optimas, objeto de estudo do presente trabalho.

A arquitetura D-Optimas é uma evolução da BIMASCO (\textit{BIo-Inspired Multi-Agent System for Combinatorial Optimization}, proposta inicialmente por \citeonline{saliba2010}. À época, o objetivo do autor era encapsular diferentes estratégias de busca em agentes, dotados de um mecanismo de aprendizagem bio-inspirada, de modo que eles pudessem colaborar e aprender a investigar o espaço de busca. A primeira versão da arquitetura era baseada em \textit{threads}, utilizando comunicação assíncrona, onde os agentes interagem com espaço de busca de maneira não determinística. Outro conceito interessante apresentado no trabalho é a segmentação do espaço de busca em regiões de interesse. 
As interações entre os agentes e regiões permitiria uma hibridização dinâmica das meta-heurísticas, voltadas para um problema específico, sem um grande esforço de configuração e calibração de parâmetros.

\citeonline{denise2014} tornou a arquitetura genérica, propondo as abstrações necessárias para desacoplar o funcionamento das meta-heurísticas das particularidades de cada problema. Dando continuidade ao trabalho, \citeonline{marcus2015} criou o modelo de comunicação entre os agentes, permitindo que eles pudessem colaborar, e verificou que de fato essa colaboração leva a arquitetura a encontrar soluções de melhor qualidade. Além disso, o autor propôs uma primeira implementação das regiões, dando ao espaço de busca uma dinâmica temporal. Entretanto, os autores tiveram dificuldades em executar experimentos de larga escala e produzir grandes volumes de dados. Isso impediu que  análises estatísticas mais robustas fossem conduzidas. Essas dificuldades estavam ligadas principalmente à uma limitação tecnológica do modelo de concorrência utilizado, baseado em \textit{threads} e compartilhamento de memória. 

% O modelo de atores é um estilo de concorrência baseado em troca de mensagens, muito adequado a modelagem de sistemas multi-agentes
\citeonline{pacheco} então propôs remodelar a arquitetura BIMASCO, mudando o mecanismo de concorrência utilizado, a fim de contornar a dificuldade de execução em problemas de larga escala. Essa nova versão da arquitetura, chamada de D-Optimas, foi implementada utilizando a biblioteca \textit{akka}, que implementa o modelo de atores \cite{hewitt2013}. Este é um modelo de concorrência mais moderno, baseado em troca de mensagens assíncronas, e não bloqueantes. Esse novo paradigma permitiu a execução de centenas de  agentes/regiões em um \textit{cluster} com 2 nós. Entretanto, não foi possível verificar o desempenho da arquitetura em \textit{clusters} maiores. O principal impedimento de estudos mais complexos era principalmente a falta de resiliência a falhas, que são mais comuns à medida que os sistemas distribuídos crescem.

% a biblioteca de atores utilizada oferece ferramentas para construir sistemas distribuídos, robustos, resilientes a falhas 

Sendo assim, a execução da arquitetura D-Optimas ficou restrita à um número limitado de nós em um \textit{cluster}, bem como à uma pequena diversidade de agentes. Estendê-la, permitindo a execução em um \textit{cluster} com um número indeterminado de nós, é essencial para a resolução de problemas em larga escala, bem como para extração de dados confiáveis necessários na análise de desempenho da arquitetura. Além disso, incluir novos algoritmos é essencial na criação de um sistema multiagente distribuído aplicado na solução de problemas de otimização. 

\section{Motivação}
% pra que? qual o contexto o que leva a desenvolver, todas as características e condições que favorecem o desenvolvimento 

% por que usar meta-heurísticas pra otimização?
Existem vários problemas da vida prática que, apesar de parecerem complexos, de larga escala e difíceis de resolver, podem ser resolvidos em milésimos de segundos, mesmo em computadores cuja as configurações são muito básicas. Por exemplo, para navegar por uma cidade desconhecida, em que o tráfego varia muito nos horários de pico, hoje é possível abrir um aplicativo no celular que calcula a rota com o menor custo até o destino em questão de segundos. Para calcular essa rota, um algoritmo de caminho mínimo \cite{xu2007} investiga as várias possíveis ruas, analisa dados obtidos de outros usuários, dados fornecidos pelo sistema de trânsito da cidade, e chega ao resultado ótimo com um tempo muito pequeno, que é normalmente uma função polinomial do tamanho da entrada. Neste caso, o tamanho da entrada pode ser considerado o tamanho da cidade, a quantidade de ruas e cruzamentos. 

Este problema clássico apresentado acima é considerado um problema de otimização, no qual o objetivo é encontrar um subconjunto dos dados de entrada que levam a um valor mínimo de uma função. Quando a relação entre o tempo para resolver o problema e o tamanho da entrada é uma função polinomial, a literatura classifica esse problema como $\mathcal{P}$ \cite{karp1972}. Entretanto, nem todo problema pode ser resolvido em tempo polinomial por um computador convencional. Por exemplo, é possível modificar ligeiramente o problema acima tornando-o mais complexo e difícil de ser resolvido. O motorista do veículo poderia ser um entregador que precisa parar em uma lista de destinos, e quer saber a rota com menor distância que passe por todos os destinos, sem repetir nenhuma rua ou avenida. Neste caso, a literatura desconhece uma estratégia melhor do que investigar sistematicamente cada uma das possíveis combinações de ruas da cidade. A relação entre o tempo e o tamanho da entrada neste caso é exponencial. Resolver este problema de forma exata para uma entrada pequena, por exemplo, um bairro com cinquenta ruas, é computacionalmente impraticável, podendo levar aproximadamente nove décadas para ser resolvido. A literatura classifica problemas deste tipo como $\mathcal{NP}$ \cite{li2015}.

Para resolver problemas da classe $\mathcal{NP}$ a literatura propõe o uso de heurísticas, estratégias de busca focadas para resolver um problema específico, e meta-heurísticas que são estratégias de busca genéricas. Essas estratégias podem ter inspiração biológica, \textit{e.g.} o algoritmo genético \cite{whitley1994}, ou serem baseadas em outros fenômenos ou propriedades do problema (heurísticas gulosas, recozimento simulado, são dois exemplos de heurísticas sem qualquer inspiração biológica). Os métodos heurísticos normalmente utilizam procedimentos estocásticos para produzir e modificar soluções para o problema e caminhar em direção a um valor ótimo, que pode ser um ótimo global ou não. Algumas heurísticas possuem vários parâmetros de configuração, o que as vezes dificulta a sua utilização, pois os parâmetros afetam diretamente a convergência do algoritmo. 

% não existe meta-heurísticas boas pra qualquer problema
% há hipotese de que a hibridização pode obter resultados melhores
Por essas características estocásticas inerentes aos métodos heurísticos, não existe nenhum método que seja bom em todos os problemas de otimização \cite[p. 30-32]{eiben2015}. Uma alternativa a essa limitação das meta-heurísticas é unir características positivas de diferentes algoritmos em um único. Esta técnica, conhecida como hibridização,  mostra-se ser mais robusta na solução de problemas mais complexos. De toda forma, a hibridização de meta-heurísticas normalmente leva a um número maior de parâmetros de configuração, o que torna o ajuste de parâmetros mais complexo e necessário.


\section{Justificativa}
% por que desenvolver? que problema isso resolve? por que é importante resolver esse problema?

% consolida a arquitetura D-Optimas como um sistema robusto
A arquitetura D-Optimas tem um grande potencial para ser aplicada em problemas de otimização de larga escala. Ela se consolidou como um sistema multi-agentes baseado em um modelo de concorrência mais moderno \footnote{https://www.reactivemanifesto.org/} e foi construída sobre uma biblioteca consolidada pelo mercado, a plataforma Akka. Além disso, possui vários algoritmos implementados e adaptados para funcionarem em qualquer problema em um ambiente distribuído. Conta com mecanismos de aprendizagem, de memória e de colaboração entre os agentes. Todos esses mecanismos trabalhando em conjunto permitem uma hibridização dinâmica das estratégias de busca, criando uma hiper-heurística sob demanda para um dado um problema de otimização.

Estender a arquitetura D-Optimas como um sistema distribuído resiliente a falhas, permitirá executá-la para solucionar diferentes problemas de otimização, em maiores escalas, nos quais a maioria dos algoritmos clássicos enfrenta dificuldade em encontrar bons resultados. As técnicas de hibridização de meta-heurísticas obtém melhores resultados neste tipo de problema, mas normalmente requerem algum conhecimento prévio do problema e um ajuste fino de parâmetros. Estudar um modelo automático capaz de hibridizar metaheurísticas configura-se um tópico de pesquisa amplo na área de otimização. Além disso, esta pesquisa permitirá a execução da arquitetura em infraestruturas modernas, como os provedores de nuvem, sendo possível  disponibilizá-la como um \textit{Software as a Service} (SaaS).

\section{Objetivos}

O objetivo geral deste trabalho é consolidar a arquitetura D-Optimas do ponto de vista de um sistema distribuído, tolerante a falhas, com balanceamento de carga e transparência de localidade, tornando-a resiliente e escalável horizontalmente. Com isso será possível executar simulações com problemas de larga escala em um \textit{cluster} com uma variedade de agentes e estratégias de busca. Espera-se observar a adaptação da arquitetura ao problema, com os agentes colaborando e, dessa forma, verificar, neste comportamento,  o surgimento de uma hibridização dinâmica das meta-heurísticas.

Para atingir este objetivo geral, é necessário cumprir os seguintes objetivos específicos: 

\begin{itemize}
    \item Compreender a arquitetura D-Optimas, seus fundamentos teóricos e seus mecanismos de generalização de problemas
    \item Estender arquitetura permitindo sua execução em um \textit{cluster} com um número arbitrário de nós
    \item Aprimorar os algoritmos da arquitetura, em especial os que definem o comportamento das regiões, para que não dependam de um conhecimento prévio do problema 
    \item Estender a D-Optimas, adicionando novas meta-heurísticas
    \item Submetê-la a uma bateria de experimentos com diferentes problemas, a fim de obter resultados confiáveis
    \item Submeter os dados a uma análise estatística adequada 
\end{itemize}

\section{Organização do Trabalho}

Situado o contexto deste trabalho, o \autoref{chap:revisao} fará uma revisão das arquiteturas de software encontradas na literatura que possuem características em comum com a D-Optimas. As principais características levadas em conta nesta seleção foram o uso da modelagem multi-agentes e a possibilidade de execução em sistemas multi-cores ou \textit{clusters}. Este capítulo também revisita o histórico da arquitetura D-Optimas, desde a sua origem na arquitetura BIMASCO, apresentando detalhes dos seus componentes e funcionamento. 

O \autoref{chap:metodologia} apresenta a metodologia adotada no desenvolvimento deste trabalho. Neste capítulo, a principal hipótese que fundamentou a construção da arquitetura D-Optimas é retomada, a saber: que a diversidade de estratégias melhora o desempenho da arquitetura em diferentes problemas de otimização. As premissas que contornam o problema de pesquisa são delineadas, entre elas, a principal, de que a estocasticidade da arquitetura impede na maioria das vezes o uso de testes estatísticos paramétricos. É também apresentado o procedimento experimental e o esquema de coleta de dados.

A nova organização da arquitetura D-Optimas é apresentada no \autoref{chap:desenvolvimento}. Esta nova versão utiliza outras ferramentas importantes da biblioteca \textit{akka}, a saber, o \textit{akka-cluster}, \textit{akka-sharding} e \textit{akka-persistence}, que permitem aos agentes manterem um estado distribuído e persistente da arquitetura. O novo funcionamento das regiões é detalhado, e a adaptação de novas meta-heurísticas à arquitetura é descrita.

Por fim, o \autoref{chap:exp_preliminares} apresenta os resultados obtidos em experimentos preliminares, para avaliar a escalabilidade e funcionamento do novo modelo da arquitetura e o \autoref{chap:exp_diversidade} apresenta os resultados dos experimentos realizados para avaliar o efeito da diversidade de agentes na qualidade das soluções obtidas. O \autoref{chap:conclusao} apresenta as conclusões do trabalho e os próximos passos para este projeto de pesquisa. 